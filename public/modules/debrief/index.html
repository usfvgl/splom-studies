<div id="debrief">

<h2 class="page-header">Thank You</h2>

<p>You completed the study in <span id="duration"></span> minutes. Thank you for your participation. It will help us understand whether animation is a promising technique for visualizing dense multiclass datasets in scatterplot matrices. For reference, your unique  response ID is:</p>

<p class="lead"><code id="postId"></code></p>

<p>If you have any comments regarding your experience, please enter them below (optional).</p>

<p><textarea name="textarea" class="form-control" rows="4" placeholder="Leave feedback here"></textarea></p>

<p><button id="submitComments" disabled="true" type="button" class="btn btn-default">Submit</button> <span class="text-muted" id="submitFeedback"></span></p>

<p class="text-muted text-center">You may now close this browser window.</p>

<br/>

</div>

<script>
(function() {
  var postId  = experimentr.postId
    , data    = {};

  d3.select("#postId").text(postId);

  var saved = experimentr.data();
  var elapsed = saved.time_diff_experiment;
  elapsed = elapsed / 1000 / 60;
  d3.select("#duration").text(elapsed.toFixed(2));

  var comments = d3.select('#debrief').select('textarea')
    .on('keypress', function() { d3.select('#submitComments').attr('disabled', null); })
    .on('blur', function() { d3.select('#submitComments').attr('disabled', null); });

  d3.select('#submitComments')
    .on('click', function () { data.comments = comments.property('value'); validate(); });

  function validate() {
    if( data.comments ) {
      experimentr.addData(data);
      d3.select('#submitComments').attr('disabled', 'true');
      d3.select('#submitFeedback').text('Feedback Submitted!');
    }
  }
}());
</script>
