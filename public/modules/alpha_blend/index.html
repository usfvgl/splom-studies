<script language="javascript" type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/p5.js/0.4.19/p5.js"></script>
<!-- uncomment lines below to include extra p5 libraries -->
<script language="javascript" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.4/addons/p5.dom.js"></script>
<!--<script language="javascript" src="libraries/p5.sound.js"></script>-->
<script language="javascript" type="text/javascript" src="../multi_scatter.js"></script>
<!-- this line removes any default padding and style. you might only need one of these values set. -->
<style> body {padding: 0; margin: 0;} </style>

<div id="alpha_blend">
	<div id="chart"></div>
	<div id="question"> Drag the box next to the legend to one of the matrix grids.</div>
</div>

<script language="javascript" type="text/javascript">
	
	var dataSource = "../data/synthetic-4-1-1.csv";
	var attr = {
		all: ["v","w","x","y","z","class"],
		use: [0, 1, 2, 3, 4]
	};
	var category = {
		name: "class",
		index: 5,
		values: ["A", "B", "C", "D"]
	};
	var animate = {
		isAnimate: false
	};
	var chartTitle = "Static Scatterplot Matrix with Alpha Blending and Draggable Box";

	var rects = [
		{
			x: 5,
			y: 1,
			xmin: 40,
			ymin: 1,
			xmax: 62,
			ymax: 2.5
		},
		{
			x: 10,
			y: 7,
			xmin: 0,
			ymin: 1000,
			xmax: 30,
			ymax: 10000
		},
		
	];
	
	var chart = multi_scatter(dataSource, attr, category, animate, "alpha_blended", chartTitle, rects, "true", "chart");
	var slider;
	
	function preload() {
		chart.preload();
	}
	
	function setup() {
		chart.setup();
	}
	
	function draw() {
		chart.draw();
	}
	
	function mouseClicked() {
		chart.mouseClicked();
	}
	
	function mousePressed() {
		chart.mousePressed();
	}

	function mouseReleased() {
		chart.mouseReleased();
	}

	function mouseMoved() {
		chart.mouseMoved();
	}
	
	function mouseDragged() {
		chart.mouseDragged();
	}
	
	(function() {
		var data = {};

		experimentr.startTimer('alpha_blending');

		d3.select("#chart")
		.on('mouseup', function() { 
			data.highlightRect = chart.highlightRect;
			console.log(data.highlightRect);
			validate();
		});

		function validate() {
			console.log(data.highlightRect);
			if(data.highlightRect.x > 0 && data.highlightRect.y > 0) {
				experimentr.endTimer('alpha_blending');
				experimentr.addData(data);
				experimentr.release();
			}
		}
	}());
	
</script>
